<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ†</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  direction: rtl;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.back-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  padding: 10px 20px;
  border-radius: 25px;
  text-decoration: none;
  font-size: 14px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  transition: all 0.3s ease;
}

.back-btn:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

.container {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 25px;
  padding: 40px;
  box-shadow: 0 20px 60px rgba(31, 38, 135, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.2);
  width: 100%;
  max-width: 450px;
  animation: slideIn 0.8s ease-out;
}

@keyframes slideIn {
  from { transform: translateY(50px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.header {
  text-align: center;
  margin-bottom: 30px;
}

.logo {
  width: 80px;
  height: 80px;
  background: linear-gradient(45deg, #667eea, #764ba2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5rem;
  color: white;
  margin: 0 auto 20px;
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
}

.header h1 {
  color: #2c3e50;
  font-size: 28px;
  margin-bottom: 10px;
  font-weight: bold;
}

.header p {
  color: #7f8c8d;
  font-size: 16px;
  line-height: 1.5;
  margin-bottom: 20px;
}

.features-list {
  background: linear-gradient(45deg, #f8f9fa, #e9ecef);
  border-radius: 15px;
  padding: 15px;
  margin-bottom: 25px;
}

.features-list h4 {
  color: #495057;
  margin-bottom: 10px;
  font-size: 14px;
  text-align: center;
}

.features-list ul {
  list-style: none;
  color: #6c757d;
  font-size: 13px;
}

.features-list li {
  margin-bottom: 5px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.features-list li:before {
  content: "âœ…";
  font-size: 12px;
}

.tabs {
  display: flex;
  background: #f8f9fa;
  border-radius: 25px;
  padding: 5px;
  margin-bottom: 25px;
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.1);
}

.tab {
  flex: 1;
  padding: 12px;
  border: none;
  background: transparent;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  color: #666;
}

.tab.active {
  background: linear-gradient(45deg, #667eea, #764ba2);
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.form-content {
  display: none;
}

.form-content.active {
  display: block;
  animation: fadeIn 0.5s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  color: #2c3e50;
  font-weight: 600;
  margin-bottom: 8px;
  font-size: 14px;
}

.input-wrapper {
  position: relative;
}

.form-input {
  width: 100%;
  padding: 16px 20px;
  border: 2px solid #e9ecef;
  border-radius: 15px;
  font-size: 16px;
  background: white;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
}

.form-input:focus {
  border-color: #667eea;
  outline: none;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  transform: translateY(-2px);
}

.form-input.error {
  border-color: #dc3545;
  background: #fff5f5;
}

.form-input.success {
  border-color: #28a745;
  background: #f8fff9;
}

.input-icon {
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #adb5bd;
  font-size: 18px;
}

.password-toggle {
  position: absolute;
  left: 15px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: #667eea;
  cursor: pointer;
  font-size: 20px;
  padding: 5px;
  border-radius: 5px;
  transition: all 0.2s ease;
}

.password-toggle:hover {
  background: rgba(102, 126, 234, 0.1);
}

.form-help {
  font-size: 12px;
  color: #6c757d;
  margin-top: 5px;
  display: flex;
  align-items: center;
  gap: 5px;
}

.validation-message {
  font-size: 12px;
  margin-top: 5px;
  padding: 8px 12px;
  border-radius: 8px;
  display: none;
}

.validation-message.error {
  background: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

.validation-message.success {
  background: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.submit-btn {
  width: 100%;
  background: linear-gradient(45deg, #667eea, #764ba2);
  color: white;
  border: none;
  padding: 18px;
  font-size: 16px;
  font-weight: bold;
  border-radius: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
  margin-top: 10px;
  position: relative;
  overflow: hidden;
}

.submit-btn:hover:not(:disabled) {
  transform: translateY(-3px);
  box-shadow: 0 10px 35px rgba(102, 126, 234, 0.6);
}

.submit-btn:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-text, .btn-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.btn-loading {
  display: none;
}

.loading-spinner {
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.alert {
  padding: 15px 20px;
  border-radius: 12px;
  margin-bottom: 20px;
  font-size: 14px;
  text-align: center;
  display: none;
  animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
  from { transform: translateY(-20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.alert.success {
  background: rgba(40, 167, 69, 0.1);
  color: #155724;
  border: 2px solid #28a745;
}

.alert.error {
  background: rgba(220, 53, 69, 0.1);
  color: #721c24;
  border: 2px solid #dc3545;
}

.alert.info {
  background: rgba(23, 162, 184, 0.1);
  color: #0c5460;
  border: 2px solid #17a2b8;
}

.divider {
  text-align: center;
  margin: 25px 0;
  position: relative;
  color: #adb5bd;
  font-size: 14px;
}

.divider:before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right, transparent, #dee2e6, transparent);
}

.divider span {
  background: white;
  padding: 0 15px;
  position: relative;
}

.guest-access {
  background: linear-gradient(45deg, #ffc107, #fd7e14);
  color: white;
  padding: 15px;
  border-radius: 12px;
  text-align: center;
  margin-top: 15px;
}

.guest-access h5 {
  margin-bottom: 8px;
  font-size: 16px;
}

.guest-access p {
  font-size: 13px;
  opacity: 0.9;
  margin-bottom: 12px;
}

.guest-btn {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 10px 20px;
  border-radius: 20px;
  text-decoration: none;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.3s ease;
  display: inline-block;
}

.guest-btn:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

/* Mobile Responsive */
@media (max-width: 480px) {
  body {
    padding: 10px;
  }

  .back-btn {
    top: 10px;
    right: 10px;
    font-size: 12px;
    padding: 8px 15px;
  }

  .container {
    padding: 30px 25px;
    margin: 10px 0;
  }

  .logo {
    width: 70px;
    height: 70px;
    font-size: 2rem;
  }

  .header h1 {
    font-size: 24px;
  }

  .header p {
    font-size: 14px;
  }

  .form-input {
    padding: 14px 18px;
  }
}

  </style>
</head>
<body>

<a href="index.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>

  <div class="container">
    <div class="header">
      <div class="logo">ğŸ‘¥</div>
      <h1>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h1>
      <p>Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø±Ø¤ÙŠØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø© ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù‡Ù… Ù…Ø¨Ø§Ø´Ø±Ø©</p>

  <div class="features-list">
    <h4>Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„:</h4>
    <ul>
      <li>Ø¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ†</li>
      <li>Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆØªØ¹Ù„ÙŠÙ‚Ø§Øª</li>
      <li>Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¹Ø¨Ø± Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„ÙˆØ§ØªØ³Ø§Ø¨</li>
      <li>Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ† Ø§Ù„Ù…ÙØ¶Ù„ÙŠÙ†</li>
    </ul>
  </div>
</div>

<div id="alertMessage" class="alert"></div>

<div class="tabs">
  <button class="tab active" onclick="showTab('login')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
  <button class="tab" onclick="showTab('register')">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
</div>

<!-- Login Form -->
<form class="form-content active" id="loginForm" data-tab="login">
  <div class="form-group">
    <label for="loginPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ“±</span>
      <input type="tel" id="loginPhone" class="form-input" placeholder="07XXXXXXXX" required>
    </div>
    <div class="form-help">
      <span>ğŸ’¡</span>
      <span>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ø§Ù„Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹</span>
    </div>
    <div id="loginPhoneValidation" class="validation-message"></div>
  </div>

  <div class="form-group">
    <label for="loginPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ”’</span>
      <input type="password" id="loginPassword" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
      <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">ğŸ‘</button>
    </div>
    <div id="loginPasswordValidation" class="validation-message"></div>
  </div>

  <button type="submit" class="submit-btn" id="loginBtn">
    <span class="btn-text">ğŸ”“ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
    <div class="btn-loading">
      <div class="loading-spinner"></div>
      <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</span>
    </div>
  </button>
</form>

<!-- Register Form -->
<form class="form-content" id="registerForm" data-tab="register">
  <div class="form-group">
    <label for="registerName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ‘¤</span>
      <input type="text" id="registerName" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" required>
    </div>
    <div class="form-help">
      <span>ğŸ’¡</span>
      <span>Ø³ÙŠØ¸Ù‡Ø± Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… ÙÙŠ ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙƒ</span>
    </div>
    <div id="registerNameValidation" class="validation-message"></div>
  </div>

  <div class="form-group">
    <label for="registerPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ“±</span>
      <input type="tel" id="registerPhone" class="form-input" placeholder="07XXXXXXXX" required>
    </div>
    <div class="form-help">
      <span>ğŸ’¡</span>
      <span>Ø³ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</span>
    </div>
    <div id="registerPhoneValidation" class="validation-message"></div>
  </div>

  <div class="form-group">
    <label for="registerPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ”’</span>
      <input type="password" id="registerPassword" class="form-input" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©" required minlength="6">
      <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')">ğŸ‘</button>
    </div>
    <div class="form-help">
      <span>ğŸ’¡</span>
      <span>ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</span>
    </div>
    <div id="registerPasswordValidation" class="validation-message"></div>
  </div>

  <div class="form-group">
    <label for="confirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <div class="input-wrapper">
      <span class="input-icon">ğŸ”’</span>
      <input type="password" id="confirmPassword" class="form-input" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
      <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">ğŸ‘</button>
    </div>
    <div id="confirmPasswordValidation" class="validation-message"></div>
  </div>

  <button type="submit" class="submit-btn" id="registerBtn">
    <span class="btn-text">âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</span>
    <div class="btn-loading">
      <div class="loading-spinner"></div>
      <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...</span>
    </div>
  </button>
</form>

<div class="divider">
  <span>Ø£Ùˆ</span>
</div>

<div class="guest-access">
  <h5>ğŸ” ØªØµÙØ­ ÙƒØ²Ø§Ø¦Ø±</h5>
  <p>ÙŠÙ…ÙƒÙ†Ùƒ ØªØµÙØ­ Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ† Ù„ÙƒÙ† Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø±Ø¤ÙŠØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ…Ø§Øª</p>
  <a href="index.html" class="guest-btn">Ù…ØªØ§Ø¨Ø¹Ø© ÙƒØ²Ø§Ø¦Ø±</a>
</div>

  </div>

  <!-- Firebase Scripts -->

  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app-compat.js"></script>

  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore-compat.js"></script>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCj5YjdiruBTCfxDnxlDd4W6YA5iCWRfE4",
      authDomain: "home-services-app-a9c5e.firebaseapp.com",
      projectId: "home-services-app-a9c5e",
      storageBucket: "home-services-app-a9c5e.appspot.com",
      messagingSenderId: "287028219636",
      appId: "1:287028219636:web:2ad4b0e092a2c007e318a1"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Form validation patterns
    const phonePattern = /^07\d{8}$/;
    const namePattern = /^[\u0600-\u06FFa-zA-Z\s]{2,50}$/;

    // Global functions
    function showTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      event.target.classList.add('active');

      // Update form content
      document.querySelectorAll('.form-content').forEach(content => {
        content.classList.remove('active');
      });
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

      hideAlert();
      autoFocusFirstInput(tabName);
    }

    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const button = input.parentElement.querySelector('.password-toggle');
      
      if (input.type === 'password') {
        input.type = 'text';
        button.textContent = 'ğŸ™ˆ';
      } else {
        input.type = 'password';
        button.textContent = 'ğŸ‘';
      }
    }

    function formatAndValidatePhone(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 0 && !value.startsWith('07')) {
        if (value.startsWith('7')) value = '0' + value;
      }
      if (value.length > 10) value = value.substring(0, 10);
      e.target.value = value;

      const validationElement = document.getElementById(e.target.id + 'Validation');
      if (value.length === 0) {
        clearValidation(e.target, validationElement);
      } else if (phonePattern.test(value)) {
        showValidation(e.target, validationElement, 'Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ âœ…', 'success');
      } else {
        showValidation(e.target, validationElement, 'ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 07 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù…', 'error');
      }
    }

    function validateName(e) {
      const value = e.target.value.trim();
      const validationElement = document.getElementById('registerNameValidation');
      
      if (value.length === 0) {
        clearValidation(e.target, validationElement);
      } else if (namePattern.test(value)) {
        showValidation(e.target, validationElement, 'Ø§Ø³Ù… ØµØ­ÙŠØ­ âœ…', 'success');
      } else {
        showValidation(e.target, validationElement, 'ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±ÙˆÙ ÙÙ‚Ø· (2-50 Ø­Ø±Ù)', 'error');
      }
    }

    function validatePassword(e) {
      const value = e.target.value;
      const validationElement = document.getElementById('registerPasswordValidation');
      
      if (value.length === 0) {
        clearValidation(e.target, validationElement);
      } else if (value.length >= 6) {
        showValidation(e.target, validationElement, 'ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© âœ…', 'success');
      } else {
        showValidation(e.target, validationElement, `ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ${6 - value.length} Ø£Ø­Ø±Ù Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„`, 'error');
      }

      // Re-validate confirm password if it has value
      const confirmPassword = document.getElementById('confirmPassword');
      if (confirmPassword.value) {
        validateConfirmPassword({ target: confirmPassword });
      }
    }

    function validateConfirmPassword(e) {
      const value = e.target.value;
      const password = document.getElementById('registerPassword').value;
      const validationElement = document.getElementById('confirmPasswordValidation');
      
      if (value.length === 0) {
        clearValidation(e.target, validationElement);
      } else if (value === password) {
        showValidation(e.target, validationElement, 'ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø© âœ…', 'success');
      } else {
        showValidation(e.target, validationElement, 'ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
      }
    }

    function showValidation(input, validationElement, message, type) {
      input.classList.remove('error', 'success');
      input.classList.add(type);
      
      validationElement.textContent = message;
      validationElement.className = `validation-message ${type}`;
      validationElement.style.display = 'block';
    }

    function clearValidation(input, validationElement) {
      input.classList.remove('error', 'success');
      validationElement.style.display = 'none';
    }

    function showAlert(message, type) {
      const alertMessage = document.getElementById('alertMessage');
      alertMessage.textContent = message;
      alertMessage.className = `alert ${type}`;
      alertMessage.style.display = 'block';
      
      // Auto hide success messages
      if (type === 'success') {
        setTimeout(hideAlert, 5000);
      }
    }

    function hideAlert() {
      const alertMessage = document.getElementById('alertMessage');
      alertMessage.style.display = 'none';
    }

    function showLoading(form, show) {
      const btn = form.querySelector('.submit-btn');
      const btnText = btn.querySelector('.btn-text');
      const btnLoading = btn.querySelector('.btn-loading');
      
      btn.disabled = show;
      btnText.style.display = show ? 'none' : 'flex';
      btnLoading.style.display = show ? 'flex' : 'none';
    }

    function autoFocusFirstInput(tabName) {
      setTimeout(() => {
        const activeForm = document.querySelector(`[data-tab="${tabName}"]`);
        if (activeForm) {
          const firstInput = activeForm.querySelector('.form-input');
          if (firstInput) firstInput.focus();
        }
      }, 300);
    }

    // Handle login form submission
    async function handleLogin(e) {
      e.preventDefault();
      hideAlert();

      const phone = document.getElementById('loginPhone').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!phone || !password) {
        showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
        return;
      }

      if (!phonePattern.test(phone)) {
        showAlert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
        document.getElementById('loginPhone').focus();
        return;
      }

      showLoading(document.getElementById('loginForm'), true);

      try {
        const customerDoc = await db.collection("customers").doc(phone).get();
        
        if (customerDoc.exists) {
          const customerData = customerDoc.data();
          
          if (customerData.password === password) {
            // Store login info
            sessionStorage.setItem('customerLoggedIn', 'true');
            sessionStorage.setItem('customerPhone', phone);
            sessionStorage.setItem('customerName', customerData.name);
            sessionStorage.setItem('loginTime', new Date().toISOString());
            
            showAlert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ†...', 'success');
            
            setTimeout(() => {
              window.location.href = 'index.html';
            }, 2000);
          } else {
            showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
            document.getElementById('loginPassword').focus();
          }
        } else {
          showAlert('Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', 'error');
          showTab('register');
        }

      } catch (error) {
        console.error('Login error:', error);
        showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
      } finally {
        showLoading(document.getElementById('loginForm'), false);
      }
    }

    // Handle registration form submission
    async function handleRegister(e) {
      e.preventDefault();
      hideAlert();

      const name = document.getElementById('registerName').value.trim();
      const phone = document.getElementById('registerPhone').value.trim();
      const password = document.getElementById('registerPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      // Validation
      if (!name || !phone || !password || !confirmPassword) {
        showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
        return;
      }

      if (!namePattern.test(name)) {
        showAlert('Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±ÙˆÙ ÙÙ‚Ø· ÙˆÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 2-50 Ø­Ø±Ù', 'error');
        document.getElementById('registerName').focus();
        return;
      }

      if (!phonePattern.test(phone)) {
        showAlert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 07 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù…', 'error');
        document.getElementById('registerPhone').focus();
        return;
      }

      if (password.length < 6) {
        showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
        document.getElementById('registerPassword').focus();
        return;
      }

      if (password !== confirmPassword) {
        showAlert('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
        document.getElementById('confirmPassword').focus();
        return;
      }

      showLoading(document.getElementById('registerForm'), true);

      try {
        // Check if phone already exists
        const existingCustomer = await db.collection("customers").doc(phone).get();
        
        if (existingCustomer.exists) {
          showAlert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ø¢Ø®Ø±', 'error');
          showTab('login');
          document.getElementById('loginPhone').value = phone;
          return;
        }

        // Create new customer account
        const customerData = {
          name: name,
          phone: phone,
          password: password,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
          isActive: true,
          preferences: {
            notifications: true,
            emailUpdates: false
          }
        };

        await db.collection("customers").doc(phone).set(customerData);

        // Auto login after successful registration
        sessionStorage.setItem('customerLoggedIn', 'true');
        sessionStorage.setItem('customerPhone', phone);
        sessionStorage.setItem('customerName', name);
        sessionStorage.setItem('loginTime', new Date().toISOString());

        showAlert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ†...', 'success');
        
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 2500);

      } catch (error) {
        console.error('Registration error:', error);
        showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
      } finally {
        showLoading(document.getElementById('registerForm'), false);
      }
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Event listeners
      document.getElementById('loginForm').addEventListener('submit', handleLogin);
      document.getElementById('registerForm').addEventListener('submit', handleRegister);

      // Real-time validation
      document.getElementById('loginPhone').addEventListener('input', formatAndValidatePhone);
      document.getElementById('registerPhone').addEventListener('input', formatAndValidatePhone);
      document.getElementById('registerName').addEventListener('input', validateName);
      document.getElementById('registerPassword').addEventListener('input', validatePassword);
      document.getElementById('confirmPassword').addEventListener('input', validateConfirmPassword);

      // Check if user is already logged in
      if (sessionStorage.getItem('customerLoggedIn') === 'true') {
        const customerName = sessionStorage.getItem('customerName');
        showAlert(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${customerName}ØŒ Ø£Ù†Øª Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„ÙØ¹Ù„. Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...`, 'info');
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 2000);
      }

      // Clear forms on page load
      document.getElementById('loginForm').reset();
      document.getElementById('registerForm').reset();
      hideAlert();
    });

    // Handle browser back button
    window.addEventListener('popstate', () => {
      hideAlert();
    });

  </script>

</body>
</html>